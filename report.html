<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <title>後端通訊測試</title>
    <style>
        body { font-family: sans-serif; padding: 2em; }
        #result { font-weight: bold; font-size: 1.2em; padding: 1em; border: 1px solid #ccc; }
    </style>
</head>
<body>
  <h1>正在測試與 Google 後端的連線...</h1>
  <p>測試結果：</p>
  <div id="result" style="color: orange;">請稍候... 正在發送請求...</div>

  <script>
    async function testConnection() {
      // 這是您之前確認過可以運作的 Apps Script URL
      const webAppUrl = 'https://script.google.com/macros/s/AKfycbwGtrEBnWBuLxlvhC_0l5m9YVm2mUNkw3jdkAGv99p6sfRuGbSIIlCNvhvAzYcje2zB/exec';
      const resultDiv = document.getElementById('result');

      try {
        const response = await fetch(webAppUrl);
        // 檢查伺服器回應是否正常
        if (!response.ok) {
            throw new Error(`伺服器回應錯誤，狀態碼: ${response.status}`);
        }
        const data = await response.json();
        
        // 成功抓到資料，顯示訊息
        resultDiv.textContent = '✅ 成功！收到的訊息是：「' + data.message + '」';
        resultDiv.style.color = 'green';

      } catch (error) {
        // 發生錯誤，顯示錯誤訊息
        resultDiv.textContent = '❌ 失敗！錯誤訊息：' + error.toString();
        resultDiv.style.color = 'red';
      }
    }

    // 頁面載入後立刻執行測試
    window.onload = testConnection;
  </script>
</body>
</html>
